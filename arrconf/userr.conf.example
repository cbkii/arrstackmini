#!/usr/bin/env bash
# shellcheck disable=SC2034
# Auto-generated by scripts/dev/sync-userconf-example.sh. Run that helper to refresh.
# Copy to ${ARR_BASE}/userr.conf (default: ${HOME}/srv/userr.conf) and edit as needed.
# Values here override the defaults from arrconf/userr.conf.defaults.sh, which loads first.

# --- Stack paths ---
ARR_BASE="${HOME}/srv"                 # Root directory for generated stack files
ARR_STACK_DIR="${ARR_BASE}/arrstack"  # Location for docker-compose.yml, scripts, and aliases
ARR_ENV_FILE="${ARR_STACK_DIR}/.env"  # Path to the generated .env secrets file
ARR_DOCKER_DIR="${ARR_BASE}/docker-data"  # Docker volumes and persistent data storage
# ARR_USERCONF_PATH="/root/srv/userr.conf"  # Optional: relocate this file outside ${ARR_BASE}
# ARRCONF_DIR="${HOME}/.config/arrstack"  # Optional: relocate Proton creds outside the repo

# --- Logging and output ---
ARR_LOG_DIR="/root/srv/arrstack/logs"           # Directory for runtime/service logs (default: /root/srv/arrstack/logs)
ARR_INSTALL_LOG="/root/srv/arrstack/logs/arrstack-install.log"   # Installer run log location (default: /root/srv/arrstack/logs/arrstack-install.log)
ARR_COLOR_OUTPUT="1"       # 1 keeps colorful CLI output, set 0 to disable ANSI colors

# --- Permissions ---
ARR_PERMISSION_PROFILE="strict"        # strict keeps secrets 600/700, collab enables group read/write (660/770)

# --- Downloads and media ---
DOWNLOADS_DIR="${HOME}/Downloads"      # Active qBittorrent download folder
COMPLETED_DIR="${DOWNLOADS_DIR}/completed"  # Destination for completed downloads
MEDIA_DIR="/media/mediasmb"            # Root of the media library share
TV_DIR="${MEDIA_DIR}/Shows"            # Sonarr TV library path
MOVIES_DIR="${MEDIA_DIR}/Movies"       # Radarr movie library path
# SUBS_DIR="${MEDIA_DIR}/subs"         # Optional Bazarr subtitles directory

# --- User identity ---
PUID="$(id -u)"                        # Numeric user ID containers should run as
PGID="$(id -g)"                        # Numeric group ID with write access (match your media group when using collab)
TIMEZONE="Australia/Sydney"            # Timezone for container logs and schedules (default: Australia/Sydney)

# --- Networking ---
LAN_IP=""                              # Bind services to one LAN IP (set a DHCP reservation or static IP before install)
LOCALHOST_IP="127.0.0.1"               # Loopback used by the Gluetun control API
LAN_DOMAIN_SUFFIX="home.arpa"          # Suffix appended to service hostnames (default: home.arpa)
CADDY_DOMAIN_SUFFIX="home.arpa"  # Override Caddy hostname suffix independently of LAN DNS (default: home.arpa)
SERVER_COUNTRIES="Netherlands"              # ProtonVPN exit country list (default: Netherlands)
# SERVER_NAMES=""                          # Optionally pin Proton server hostnames (comma-separated) if PF stays at 0
PVPN_ROTATE_COUNTRIES="Netherlands"  # Optional rotation order for arr.vpn switch (default mirrors SERVER_COUNTRIES)
GLUETUN_CONTROL_PORT="8000"            # Host port that exposes the Gluetun control API (default: 8000)
ENABLE_LOCAL_DNS="0"                   # Advanced: enable the optional dnsmasq container (0/1, default: 0)
ENABLE_CADDY="0"                       # Optional Caddy reverse proxy (run ./arrstack.sh --enable-caddy or set 1 to add HTTPS hostnames)
ENABLE_CONFIGARR="1"             # Configarr one-shot sync for TRaSH-Guides profiles (set 0 to omit the container)
DNS_DISTRIBUTION_MODE="router"         # router (DHCP Option 6) or per-device DNS settings (default: router)
UPSTREAM_DNS_SERVERS="1.1.1.1,1.0.0.1"          # Comma-separated resolver list used by dnsmasq (default chain shown)
UPSTREAM_DNS_1="1.1.1.1"               # Legacy primary resolver override (default derived: 1.1.1.1)
UPSTREAM_DNS_2="1.0.0.1"               # Legacy secondary resolver override (default derived: 1.0.0.1)
CADDY_LAN_CIDRS="127.0.0.1/32,::1/128,10.0.0.0/8,172.16.0.0/12,192.168.0.0/16"  # Clients allowed to skip Caddy auth (default: 127.0.0.1/32,::1/128,10.0.0.0/8,172.16.0.0/12,192.168.0.0/16)
EXPOSE_DIRECT_PORTS="1"                # Keep 1 so WebUIs publish on http://${LAN_IP}:PORT (requires LAN_IP set to your private IPv4)

# --- Credentials ---
QBT_USER="admin"                       # Initial qBittorrent username (change after first login)
QBT_PASS="adminadmin"                  # Initial qBittorrent password (update immediately after install)
GLUETUN_API_KEY=""                     # Pre-seed a Gluetun API key or leave empty to auto-generate
QBT_DOCKER_MODS="ghcr.io/vuetorrent/vuetorrent-lsio-mod:latest"  # Vuetorrent WebUI mod (set empty to disable)
QBT_AUTH_WHITELIST="127.0.0.1/32,::1/128"  # CIDRs allowed to bypass the qBittorrent login prompt (default: 127.0.0.1/32,::1/128)
CADDY_BASIC_AUTH_USER="user"           # Username clients outside CADDY_LAN_CIDRS must use (default: user)
CADDY_BASIC_AUTH_HASH=""               # Bcrypt hash for the Basic Auth password (regen when empty)

# --- Service ports ---
QBT_HTTP_PORT_HOST="8080"              # qBittorrent WebUI port exposed on the LAN (default: 8080)
SONARR_PORT="8989"                     # Sonarr WebUI port exposed on the LAN (default: 8989)
RADARR_PORT="7878"                     # Radarr WebUI port exposed on the LAN (default: 7878)
PROWLARR_PORT="9696"                   # Prowlarr WebUI port exposed on the LAN (default: 9696)
BAZARR_PORT="6767"                     # Bazarr WebUI port exposed on the LAN (default: 6767)
FLARESOLVERR_PORT="8191"               # FlareSolverr service port exposed on the LAN (default: 8191)

# --- ProtonVPN port-forward timing (advanced) ---
PF_MAX_TOTAL_WAIT="60"          # Max seconds to wait for a forwarded port before failing (default: 60)
PF_POLL_INTERVAL="5"            # Seconds between Proton API checks while waiting (default: 5)
PF_CYCLE_AFTER="30"                # Seconds before retrying with a new Proton server (default: 30)
PF_ASYNC_MAX_TOTAL_WAIT="45"    # Async helper max wait time when rotating (default: 45)
PF_ASYNC_POLL_INTERVAL="5"      # Async helper polling interval in seconds (default: 5)
PF_ASYNC_CYCLE_AFTER="30"          # Async helper retry interval for fresh ports (default: 30)

# --- Container images (advanced) ---
# GLUETUN_IMAGE="qmcgaw/gluetun:v3.39.1"                     # Override the Gluetun container tag
# QBITTORRENT_IMAGE="lscr.io/linuxserver/qbittorrent:5.1.2-r2-ls415"  # Override the qBittorrent container tag
# SONARR_IMAGE="lscr.io/linuxserver/sonarr:4.0.15.2941-ls291"         # Override the Sonarr container tag
# RADARR_IMAGE="lscr.io/linuxserver/radarr:5.27.5.10198-ls283"        # Override the Radarr container tag
# PROWLARR_IMAGE="lscr.io/linuxserver/prowlarr:latest"                # Override the Prowlarr container tag
# BAZARR_IMAGE="lscr.io/linuxserver/bazarr:latest"                    # Override the Bazarr container tag
# FLARESOLVERR_IMAGE="ghcr.io/flaresolverr/flaresolverr:v3.3.21"      # Override the FlareSolverr container tag
# CONFIGARR_IMAGE="ghcr.io/raydak-labs/configarr:latest"            # Override the Configarr container tag
# CADDY_IMAGE="caddy:2.8.4"                      # Override the Caddy reverse-proxy container tag

# --- ConfigArr quality/profile defaults ---
ARR_VIDEO_MIN_RES="720p"         # Minimum allowed resolution (default: 720p)
ARR_VIDEO_MAX_RES="1080p"         # Maximum allowed resolution (default: 1080p)
ARR_EP_MIN_MB="250"                 # Minimum episode size in MB (default: 250)
ARR_EP_MAX_GB="5"                 # Maximum episode size in GB (default: 5)
ARR_TV_RUNTIME_MIN="45"       # Minimum runtime to treat content as standard TV (default: 45)
ARR_SEASON_MAX_GB="30"         # Cap on total season size in GB (default: 30)
ARR_LANG_PRIMARY="en"           # Preferred audio/subtitle language (default: en)
ARR_ENGLISH_ONLY="1"           # 1 prefers English-only releases (default: 1)
ARR_DISCOURAGE_MULTI="1"   # 1 penalises multi-audio releases (default: 1)
ARR_PENALIZE_HD_X265="1"   # 1 lowers HD x265 release scores (default: 1)
ARR_STRICT_JUNK_BLOCK="1" # 1 fully blocks junk releases (default: 1)
ARR_JUNK_NEGATIVE_SCORE="-1000"         # Score applied to junk terms (default: -1000)
ARR_X265_HD_NEGATIVE_SCORE="-200"   # Score penalty for HD x265 (default: -200)
ARR_MULTI_NEGATIVE_SCORE="-50"       # Score penalty for multi-audio releases (default: -50)
ARR_ENGLISH_POSITIVE_SCORE="50"   # Score bonus for English releases (default: 50)
SONARR_TRASH_TEMPLATE="sonarr-v4-quality-profile-web-1080p" # TRaSH template slug ConfigArr applies to Sonarr (default: sonarr-v4-quality-profile-web-1080p)
RADARR_TRASH_TEMPLATE="radarr-v5-quality-profile-hd-bluray-web" # TRaSH template slug ConfigArr applies to Radarr (default: radarr-v5-quality-profile-hd-bluray-web)
ARR_MBMIN_DECIMALS="1"       # Decimals precision for minimum size rules (default: 1)

# --- Behaviour toggles ---
# ASSUME_YES="0"                         # Skip confirmation prompts when scripting installs
# FORCE_ROTATE_API_KEY="0"               # Force regeneration of the Gluetun API key on next run
# FORCE_REGEN_CADDY_AUTH="0"             # Rotate the Caddy username/password on next run
# SETUP_HOST_DNS="0"                      # Automate host DNS takeover helper (or call with --setup-host-dns)
# REFRESH_ALIASES="0"                     # Regenerate helper aliases without running the installer
