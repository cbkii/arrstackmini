← [Back to Start](../README.md)

# Config reference

Use this checklist to decide which `arrconf/userconf.sh` values to edit before running the installer.

## Configuration precedence

Values load in three layers so the last writer wins:

1. **Environment variables** – anything exported in the shell before running `./arrstack.sh` takes top priority (useful for CI or
   temporary overrides).
2. **`arrconf/userconf.sh`** – the copy you maintain locally. Edit this file for long-term changes.
3. **`arrconf/userconf.defaults.sh`** – shipped defaults. `scripts/dev/sync-userconf-example.sh` renders
   `arrconf/userconf.sh.example` from these values to avoid drift.

The installer prints the resolved value for each setting during preflight. If something looks wrong, check for stray environment
exports before editing `userconf.sh`.

## Why
Clear defaults keep the stack reproducible. Changing only what you need reduces mistakes and makes reruns predictable.

## Do
### Start here (edit these first)
- **`LAN_IP`** – set to your Pi (example `192.168.1.50`) and reserve it in DHCP so it never changes. The installer refuses to expose ports until this is a private IPv4.
- **`LAN_DOMAIN_SUFFIX`** – optional suffix for DNS/reverse proxy hostnames. Leave blank unless you plan to enable local DNS/Caddy.
- **`ARR_BASE`** – default `~/srv`. Change if you store Docker data elsewhere.
- **`DOWNLOADS_DIR` / `COMPLETED_DIR` / `MEDIA_DIR`** – point these at storage with enough space.
- **`TIMEZONE`** – set to your region (e.g. `Europe/Amsterdam`).
- **`SERVER_COUNTRIES`** – choose the ProtonVPN exit country list (comma-separated) that matches where you want traffic to appear.

### DNS and networking
- **`ENABLE_LOCAL_DNS`** – Disabled by default. Set to `1` to run dnsmasq and manage LAN hostnames; requires `LAN_DOMAIN_SUFFIX` and upstream DNS servers.
- **`DNS_DISTRIBUTION_MODE`** – choose `router` or `per-device` (see [LAN DNS & network pre-start](lan-dns-network-setup.md)).
- **`UPSTREAM_DNS_SERVERS`** – comma-separated resolver list (e.g. `1.1.1.1,1.0.0.1`). The installer probes them during preflight and prioritises responsive servers first. Legacy `UPSTREAM_DNS_1`/`UPSTREAM_DNS_2` still work and override the first two positions when set.
- **`GLUETUN_CONTROL_PORT`** – keep `8000` unless another local service uses it.
- **`EXPOSE_DIRECT_PORTS`** – defaults to `1` so every WebUI is reachable at `http://LAN_IP:PORT`. Leave it enabled and provide a private `LAN_IP`; the installer exits if either requirement is missing.

### Credentials and security
- **`QBT_USER` / `QBT_PASS`** – update after first login to qBittorrent. Keep `.env` in sync.
- **`CADDY_BASIC_AUTH_USER` / `CADDY_BASIC_AUTH_HASH`** – rotated automatically by `./arrstack.sh --rotate-caddy-auth`. Leave blank to let the script manage them.
- **`GLUETUN_API_KEY`** – generated by the installer. Do not edit by hand; use `./arrstack.sh --rotate-api-key` when needed.
- **`QBT_AUTH_WHITELIST`** – CIDR list that can bypass qBittorrent’s login. Leave it blank to let the installer keep loopback and
  automatically add your LAN `/24` from `LAN_IP`.

### Media apps and images
- **`QBT_DOCKER_MODS`** – Vuetorrent skin for qBittorrent. Keep default unless you know you need a different mod.
- **Image tags (`*_IMAGE`)** – pinned to known-good releases. Update only after reading [Version management](VERSION_MANAGEMENT.md).
- **Service ports (`*_PORT`)** – these become LAN ports if you enable direct exposure. Otherwise Caddy serves everything on 80/443.

### Advanced flags (rarely change)
- **`ASSUME_YES`** – set to `1` only for unattended installs.
- **`FORCE_ROTATE_API_KEY`**, **`FORCE_REGEN_CADDY_AUTH`**, **`SETUP_HOST_DNS`**, **`REFRESH_ALIASES`** – automation knobs used by `arrstack.sh`. Trigger them with command-line flags instead of editing the file directly.

After editing, save the file and keep `arrconf/userconf.sh` out of version control (it is already ignored).

## Verify
Run the installer in summary mode to confirm your values:
```bash
./arrstack.sh --yes
```
Review the printed configuration table before containers start. Cancel with `Ctrl+C` if something looks wrong, adjust the file, and rerun.

## See also
- [Quick start](../README.md)
- [LAN DNS & network pre-start](lan-dns-network-setup.md)
- [Host DNS helper](host-dns-helper.md)
- [Version management](VERSION_MANAGEMENT.md)
